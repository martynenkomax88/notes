---
id: exploit_setuid_binaries
aliases: []
tags: []
---

## SETUID binaries:                                                                                                                                                                                                                                                                                                                                                                                                             
  -The setuid/setgid (SUID/SGID) bits allows the binary to run with the privileges of the user/group owner instead of those of the user executing it. They can be spotted with the s or S permission in the file user or group owner permissions (i.e. ---s--s---). When the file permissions features an uppercase S instead of a lowercase one, it means the corresponding user or group owner doesn't have execution rights. 
### Find SETUID binaries                                                                                                                                                                                                                                                                                                                                                                                                        
```bash                                                                                                                                                                                                                                                                                                                                                                                                                         
find $starting_path -perm -u=s -type f 2>/dev/null                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                
# Or in octal mode                                                                                                                                                                                                                                                                                                                                                                                                              
find $starting_path -perm -4000 -type f 2>/dev/null                                                                                                                                                                                                                                                                                                                                                                             
```                                                                                                                                                                                                                                                                                                                                                                                                                             
 ### Exploit SETUID binaries:                                                                                                                                                                                                                                                                                                                                                                                                   
  1) #### Living off the land                                                                                                                                                                                                                                                                                                                                                                                                   
      a)                                                                                                                                                                                                                                                                                                                                                                                                                        
  2) #### Relative path calls                                                                                                                                                                                                                                                                                                                                                                                                   
      a) We can make a SETUID program execute a malicious program if it calls the programs by relative path                                                                                                                                                                                                                                                                                                                     
      b) It can be discovered with `strace` command                                                                                                                                                                                                                                                                                                                                                                             
      c) Exploitation flow:                                                                                                                                                                                                                                                                                                                                                                                                     
        - Create malicious program with the same name as the one SETUID executes                                                                                                                                                                                                                                                                                                                                                
        - Change the $PATH variable so the exploit is in PATH                                                                                                                                                                                                                                                                                                                                                                   
        - Now when the SUID will make the call it twill search for it in the PATH and execute the exploit                                                                                                                                                                                                                                                                                                                       
3. ###                                                                                                                                                                                                                                                                                                                                                                                                                          

